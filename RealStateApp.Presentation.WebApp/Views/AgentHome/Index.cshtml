@using RealStateApp.Core.Application.ViewModels
@model HomeViewModel
@{
    ViewData["Title"] = "Home Page";
	Layout = "_AgentLayout";
}
<!-- Mensaje de bienvenida -->
<div class="text-center mb-4">
    <h2 class="fw-bold">Bienvenido, @ViewBag.AgentName 👋</h2>
    <p class="text-muted">Gestiona tus inmuebles y conecta con potenciales clientes.</p>

</div>
<form method="get" asp-action="Index" class="mb-4 mx-auto" style="max-width: 500px;">
    <div class="input-group shadow-sm">
        <span class="input-group-text"><i class="bi bi-search"></i></span>
        <input type="text" asp-for="Code" class="form-control" placeholder="Buscar propiedad por código" />
        <button class="btn btn-primary" type="submit">Buscar</button>
    </div>
</form>


<!-- Filtros -->
<form method="get" asp-action="Index" class="row g-3 mb-4">
    <div class="col-md-3">
        <label class="form-label">Tipo de propiedad</label>
        <select asp-for="PropertyTypeId" class="form-select">
            <option value="">Todas</option>
            @foreach (var propertyType in Model.PropertyTypes!)
            {
                <option value="@propertyType.Id">@propertyType.Name</option>
            }
        </select>
    </div>

    <div class="col-md-2">
        <label class="form-label">Precio mínimo</label>
        <input type="number" asp-for="MinPrice" class="form-control" placeholder="RD$">
    </div>

    <div class="col-md-2">
        <label class="form-label">Precio máximo</label>
        <input type="number" asp-for="MaxPrice" class="form-control" placeholder="RD$">
    </div>

    <div class="col-md-2">
        <label class="form-label">Habitaciones</label>
        <input type="number" asp-for="Bedrooms" class="form-control" min="0">
    </div>

    <div class="col-md-2">
        <label class="form-label">Baños</label>
        <input type="number" asp-for="Bathrooms" class="form-control" min="0">
    </div>

    <div class="col-md-1 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Filtrar</button>
    </div>
</form>

<div class="row g-4">
    @if (Model != null && Model.Properties!.Any())
    {
        foreach (var propiedad in Model.Properties!)
        {

            <div class="col-md-4">
                <a asp-controller="Property" asp-action="Details" asp-route-Id="@(propiedad.Id)" asp-route-Addons="@(true)" style="text-decoration: none; color: inherit;">
                    <div class="card shadow-sm h-100 position-relative ">

                        <img src="@(propiedad.Images != null ? propiedad.Images!.FirstOrDefault()!.Url : "https://thumb.ac-illust.com/b1/b170870007dfa419295d949814474ab2_t.jpeg")"
                             class="card-img-top img-fluid"
                             style="height: 200px; object-fit: cover;"
                             alt="Imagen Propiedad" />

                        @if (!propiedad.IsAvailable)
                        {
                            <span class="badge bg-danger position-absolute top-0 end-0 m-2 fs-6">
                                VENDIDA
                            </span>

                        }

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@propiedad.PropertyType!.Name</h5>
                            <p class="card-text mb-1"><i class="bi bi-key"></i> @propiedad.Code</p>
                            <p class="card-text mb-1"><i class="bi bi-house-gear-fill"></i> @propiedad.SaleType.Name</p>
                            <p class="card-text mb-1">
                                <i class="bi bi-currency-dollar me-2"></i> RD @propiedad.Price
                            </p>

                            <p class="card-text mb-1">
                                <i class="bi bi-aspect-ratio me-2"></i> @propiedad.SizeInMeters m²
                            </p>

                            <p class="card-text mb-1">
                                <i class="bi bi-door-open me-2"></i> @propiedad.Bedrooms Hab.
                            </p>

                            <p class="card-text mb-1">
                                <i class="bi bi-bucket me-2"></i> @propiedad.Bathrooms Baños
                            </p>

                        </div>
                    </div>
                </a>
            </div>
        }
    }
    else
    {
        <div class="col-12">
            <div class="alert alert-info">No hay propiedades disponibles.</div>
        </div>
    }
</div>